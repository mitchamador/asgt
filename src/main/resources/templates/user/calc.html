<!DOCTYPE html>
<html xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:th="http://www.thymeleaf.org"
      layout:decorate="~{fragments/layout}">

<head>
    <title></title>
</head>
<body>
<div layout:fragment="content" th:remove="tag">

    <script type="application/javascript">
        $(document).ready($(function () {
            $("#calcButton").click(function (e) {
                var params = {
                    e: e,
                    text: "#calcData",
                    button: "#calcButton",
                    message: "#calcResult"
                };
                calc(params);
            });
            $("#calcResult").contextmenu(function (e) {
                $(this).text("");
                e.preventDefault();
            });
            $("#uploadButton").click(function (e) {
                $("#calcData").val("");
                $("#xmlFileName").text("");
                $(this).blur();
                $("#xmlButton").click();
            });
            $("#xmlButton").change(function (e) {
                var file = e.target.files[0];
                if (file.type !== "text/xml") {
                    return;
                }
                $("#xmlFileName").text(file.name);
                var reader = new FileReader();
                reader.addEventListener('load', function (ev) {
                    $("#calcData").val(ev.target.result);
                });
                reader.readAsText(file);
                $("#xmlButton").val("");
            })
        }));
    </script>

    <div class="page-header-name">Расчет</div>

    <div>
        <div class="row form-group">
            <input id="xmlButton" type="file" accept=".xml, text/xml" style="display: none;">
            <div style="display: inline-flex; align-items: center; width: 100%">
                <label for="calcData">XML данные</label>
                <div id="xmlFileName" style="flex-grow: 1; height: auto; font-style: initial; font-size:0.75em; text-align: right"></div>
                <div style="width: 10px"></div>
                <button id="uploadButton" class="btn btn-default btn-outline" style="border: none"><i class="fa fa-file"></i></button>
            </div>
            <textarea id="calcData" class="form-control" rows="5"
                      style="height: 26vh; font-size: 0.9em; font-family: monospace"></textarea>
        </div>

        <div class="form-inline row">
            <button id="calcButton" class="col-sm-offset-10 col-sm-2 btn btn-primary" type="button"
                    data-loading-text="<i class='fa fa-spinner fa-spin '></i> Расчет">
                Расчет
            </button>
        </div>

        <div class="row form-group">
            <label for="calcResult">Результат</label>
            <textarea id="calcResult" class="form-control" rows="5"
                      style="height: 40vh; font-size: 0.9em; font-family: monospace" readonly></textarea>
        </div>
    </div>


    <!--
        <p class="text-left"><a href="javascript:javascript:history.go(-1)" >Вернуться</a></p>
    -->
</div>

</body>

</html>